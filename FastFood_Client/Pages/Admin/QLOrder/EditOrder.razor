@page "/editorder/{orderId:guid}"
@using Data.Models.OrderModels
@using FastFood_Client.HttpRepositories.Interfaces
@layout AdminLayout

@inject IHttpOrderService OrderService
@inject NavigationManager Navigation

<!-- begin row -->
<div class="row">
    <div class="col-md-12 m-b-30">
        <!-- begin page title -->
        <div class="d-block d-sm-flex flex-nowrap align-items-center">
            <div class="page-title mb-2 mb-sm-0">
                <h1>Sửa trạng thái đơn hàng</h1>
            </div>
        </div>
        <!-- end page title -->
    </div>
</div>
<!-- end row -->
<!-- begin row -->
<div class="row">
    <div class="col-lg-12">
        <div class="row">
            <div class="col-md-5">
                <div class="form-group mb-3">
                    <button @onclick="NavigateToOrders" class="btn btn-danger">
                        Trở về
                    </button>
                </div>

                @if (order != null)
                {
                    <EditForm Model="@order" OnValidSubmit="HandleValidSubmit">
                        <div class="row">
                            <div class="form-group mb-3">
                                <label>Trạng thái</label>
                                <InputSelect class="form-control" @bind-Value="order.OrderStatus">
                                    <option value="">Chọn trạng thái</option>
                                    <option value="Pending">Đang xử lí</option>
                                    <option value="Confirmed">Đã xác nhận</option>
                                    <option value="Shipping">Đang giao</option>
                                    <option value="Delivered">Đã giao</option>
                                    <option value="Cancelled">Đã hủy</option>
                                </InputSelect>
                            </div>
                        </div>

                        <div class="form-group">
                            <button class="btn btn-primary w-100" type="submit">Lưu Thay Đổi</button>
                        </div>
                    </EditForm>
                }
                else
                {
                    <p>Loading...</p>
                }
            </div>
        </div>
    </div>
</div>
<!-- end row -->
@code {
    [Parameter] public Guid orderId { get; set; }
    private OrderForView order;

    protected override async Task OnInitializedAsync()
    {
        order = await OrderService.GetOrderByIdAsync(orderId);
    }

    private async Task HandleValidSubmit()
    {
        Navigation.NavigateTo("/orders");
    }

    private void NavigateToOrders()
    {
        Navigation.NavigateTo("/orders");
    }
}
